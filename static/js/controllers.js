!function(){"use strict";angular.module("setupsSharingAppControllers",[]).controller("homeCtrl",function($scope,$http){$http.get("/api/get-all-sims/").success(function(data,status,headers,config){$scope.sims=data}).error(function(data,status,headers,config){console.log(status)})}).controller("setupListCtrl",function($scope,$routeParams,$http){$http.get("/api/get-sim-infos/"+$routeParams.simName).success(function(data,status,headers,config){console.log(data),$scope.sim_infos=data}).error(function(data,status,headers,config){console.log(status)}),$http.get("/api/get-setups/"+$routeParams.simName).success(function(data,status,headers,config){_.forEach(data,function(setup){setup.car=setup.car.name,setup.track=setup.track.name,setup.authorid=setup.author._id,setup.author=setup.author.display_name}),$scope.setups=data}).error(function(data,status,headers,config){console.log(status)}),$http.get("/api/get-setups-filters-by-simname/"+$routeParams.simName).success(function(data,status,headers,config){console.log(data),$scope.setup_filters=data}).error(function(data,status,headers,config){console.log(status)}),$scope.sim_name=$routeParams.simName,$scope.predicate="added_date.timestamp",$scope.reverse=!0,$scope.order=function(predicate){$scope.reverse=$scope.predicate===predicate?!$scope.reverse:!1,$scope.predicate=predicate}}).controller("setupDetailCtrl",function($scope,$routeParams,$http){$http.get("/api/get-sim-infos/"+$routeParams.simName).success(function(data,status,headers,config){$scope.simId=data._id}).error(function(data,status,headers,config){console.log(status)}),$http.get("/api/get-setup/"+$routeParams.setupId).success(function(data,status,headers,config){$scope.setup=data}).error(function(data,status,headers,config){console.log(status)}),$http.get("/api/get-setup-file-details/"+$routeParams.setupId).success(function(data,status,headers,config){data=data.replace(/\n/g,"").split("["),data.shift();var setupDetailsObj={};_.forEach(data,function(setup_item){var setupItemArray=setup_item.split(/]/g),setupItemKey=setupItemArray[0],setupItemValue=setupItemArray[1].replace("VALUE=","");"FUEL"===setupItemKey?setupDetailsObj.fuel=setupItemValue:"PRESSURE_LF"===setupItemKey?setupDetailsObj.pressure_lf=setupItemValue:"PRESSURE_RF"===setupItemKey?setupDetailsObj.pressure_rf=setupItemValue:"PRESSURE_LR"===setupItemKey?setupDetailsObj.pressure_lr=setupItemValue:"PRESSURE_RR"===setupItemKey?setupDetailsObj.pressure_rr=setupItemValue:"TOE_OUT_LF"===setupItemKey?setupDetailsObj.toe_out_lf=setupItemValue:"TOE_OUT_LR"===setupItemKey?setupDetailsObj.toe_out_lr=setupItemValue:"TOE_OUT_RF"===setupItemKey?setupDetailsObj.toe_out_rf=setupItemValue:"TOE_OUT_RR"===setupItemKey&&(setupDetailsObj.toe_out_rr=setupItemValue)}),$scope.setup_details=setupDetailsObj}).error(function(data,status,headers,config){console.log(status)}),$scope.sim_name=$routeParams.simName}).controller("submitSetupCtrl",function($scope,$routeParams,SimService){SimService.returnSimsFullData().then(function(result){console.log("result",result),$scope.sims=result}),$scope.uploadFile=function($scope){var filename=event.target.files[0].name;angular.element(event.srcElement.parentElement.parentElement.querySelector("#setup-file-display-name")).html(filename),angular.element(event.srcElement.parentElement.querySelector("#setup-file-hidden")).val(filename)},$scope.sim_name=$routeParams.simName}).controller("userProfileCtrl",function($scope,$routeParams,$http){var logged_user_id=angular.element(document.querySelector("#logged-userid")).val();$http.get("/api/get-user-by-id/"+$routeParams.userid).success(function(data,status,headers,config){$scope.user=data,$scope.user.own_profile=logged_user_id&&logged_user_id===$routeParams.userid?!0:!1}).error(function(data,status,headers,config){console.log(status)}),$http.get("/api/get-setups-by-user/"+$routeParams.userid).success(function(data,status,headers,config){var total_downloads=0;_.forEach(data,function(setup){setup.car=setup.car.name,setup.track=setup.track.name,setup.author=setup.author.display_name,setup.simid=setup.sim._id,setup.sim=setup.sim.display_name,total_downloads+=setup.downloads}),$scope.setups=data,$scope.setups_count=$scope.setups.length,$scope.total_downloads=total_downloads}).error(function(data,status,headers,config){console.log(status)}),$http.get("/api/get-setups-filters-by-userid/"+$routeParams.userid).success(function(data,status,headers,config){$scope.setup_filters=data}).error(function(data,status,headers,config){console.log(status)}),$scope.updateUsername=function(){var newUsername=angular.element(event.srcElement.parentElement.querySelector("#profile-change-username")).val();$http.get("/api/get-user-by-name/"+newUsername).success(function(data,status,headers,config){data?angular.element(document.querySelector(".profile-change-username-msg-box")).html("This username is already in use, please try another one."):($http.post("/api/update-user-displayname/",{userId:$routeParams.userid,newDisplayName:newUsername}).success(function(data,status,headers,config){console.log("User display_name updated successfully")}).error(function(data,status,headers,config){console.log(status)}),angular.element(document.querySelector(".profile-change-username-msg-box")).html("Username successfully updated."))}).error(function(data,status,headers,config){console.log(status)})},$scope.predicate="added_date.timestamp",$scope.reverse=!0,$scope.order=function(predicate){$scope.reverse=$scope.predicate===predicate?!$scope.reverse:!1,$scope.predicate=predicate}}).controller("manageUsersCtrl",function($scope,$routeParams,$http){console.log("manage users"),$http.get("/api/get-all-users/").success(function(data,status,headers,config){console.log(data),$scope.users=data}).error(function(data,status,headers,config){console.log(status)})}).controller("manageSimsCtrl",function($scope,$routeParams,$http){console.log("manage sims")}).controller("manageCarsCtrl",function($scope,$routeParams,$http){console.log("manage cars"),$http.get("/api/get-all-cars/").success(function(data,status,headers,config){console.log(data),$scope.cars=data}).error(function(data,status,headers,config){console.log(status)})}).controller("manageTracksCtrl",function($scope,$routeParams,$http){console.log("manage tracks"),$http.get("/api/get-all-tracks/").success(function(data,status,headers,config){console.log(data),$scope.tracks=data}).error(function(data,status,headers,config){console.log(status)})}).controller("addSimsCtrl",function($scope,$routeParams,$http){console.log("add sims"),$scope.addSim=function(){$scope.simCode&&$scope.simDisplayName&&$http.post("/api/add-sim/",{simCode:$scope.simCode,simDisplayName:$scope.simDisplayName}).success(function(data,status,headers,config){console.log("success"),angular.element(document.querySelector("#msg-box")).html("Sim successfully created.")}).error(function(data,status,headers,config){console.log(status)})["catch"](function(error){console.log(error)})}}).controller("addCarsCtrl",function($scope,$routeParams,$http){console.log("add cars"),$scope.addCar=function(){$scope.carName&&$scope.carCategory&&$http.post("/api/add-car/",{carName:$scope.carName,carCategory:$scope.carCategory,sim:"55c2cddddebcbba924bb2a34"}).success(function(data,status,headers,config){console.log("success"),angular.element(document.querySelector("#msg-box")).html("Car successfully created.")}).error(function(data,status,headers,config){console.log(status)})["catch"](function(error){console.log(error)})}}).controller("addTracksCtrl",function($scope,$routeParams,$http){console.log("add tracks"),$scope.addTrack=function(){$scope.trackName&&$http.post("/api/add-track/",{trackName:$scope.trackName,sim:"55c2cddddebcbba924bb2a34"}).success(function(data,status,headers,config){console.log("success"),angular.element(document.querySelector("#msg-box")).html("Track successfully created.")}).error(function(data,status,headers,config){console.log(status)})["catch"](function(error){console.log(error)})}})}();